function calcFFT()

    V = [6.219397e+00, 8.220310e+00, 8.862213e+00, 8.060610e+00, 6.181881e+00, 3.909755e+00, 1.999020e+00, 1.008486e+00, 1.112520e+00, 2.060295e+00, 3.295702e+00, 4.190074e+00, 4.297374e+00, 3.533537e+00, 2.211012e+00, 9.152619e-01, 2.705943e-01, 6.854146e-01, 2.175338e+00, 4.333498e+00, 6.461763e+00, 7.815500e+00, 7.871186e+00, 6.517000e+00, 4.095077e+00, 1.279543e+00, -1.163999e+00, -2.647714e+00, -2.959323e+00, -2.315793e+00, -1.255055e+00, -4.092503e-01, -2.475993e-01, -8.880182e-01, -2.049875e+00, -3.166026e+00, -3.611110e+00, -2.958289e+00, -1.165226e+00, 1.383482e+00, 3.996004e+00, 5.912172e+00, 6.573182e+00, 5.821545e+00, 3.956506e+00, 1.624229e+00, -4.161346e-01, -1.563016e+00, -1.578880e+00, -6.565426e-01, 6.773494e-01, 1.782674e+00, 2.164358e+00, 1.669408e+00, 5.467510e-01, -6.530736e-01, -1.299836e+00, -9.417997e-01, 4.995471e-01, 2.674285e+00, 4.911792e+00, 6.453004e+00, 6.721334e+00, 5.531244e+00, 3.156458e+00, 2.322413e-01, -2.471655e+00, -4.322551e+00, -5.039759e+00, -4.773669e+00, -4.021513e+00, -3.414216e+00, -3.457354e+00, -4.326181e+00, -5.793532e+00, -7.318333e+00, -8.260739e+00, -8.141240e+00, -6.843733e+00, -4.683384e+00, -2.311126e+00, -4.885330e-01, 1.837366e-01, -5.172444e-01, -2.355709e+00, -4.722395e+00, -6.854008e+00, -8.104891e+00, -8.169665e+00, -7.174647e+00, -5.605840e+00, -4.103225e+00, -3.201547e+00, -3.117599e+00, -3.665757e+00, -4.334183e+00, -4.492386e+00, -3.650350e+00, -1.669204e+00, 1.158644e+00, 4.192782e+00, 6.662390e+00, 7.937942e+00, 7.755831e+00, 6.311961e+00, 4.189284e+00, 2.146449e+00, 8.466097e-01, 6.275055e-01, 1.397792e+00, 2.696491e+00, 3.890562e+00, 4.433451e+00, 4.084789e+00, 3.006768e+00, 1.700167e+00, 8.045762e-01, 8.396034e-01, 1.986820e+00, 3.997277e+00, 6.262059e+00, 8.021573e+00, 8.636470e+00, 7.819295e+00, 5.740250e+00, 2.967434e+00, 2.639192e-01, -1.682470e+00, -2.495938e+00, -2.228487e+00, -1.313236e+00, -3.754918e-01, 2.451862e-02, -3.821393e-01, -1.464970e+00, -2.745519e+00, -3.588691e+00, -3.460418e+00, -2.152325e+00, 1.139062e-01, 2.744470e+00, 4.974205e+00, 6.136371e+00, 5.901075e+00, 4.393236e+00, 2.145970e+00, -9.314111e-02, -1.630382e+00, -2.068733e+00, -1.435226e+00, -1.469465e-01, 1.168983e+00, 1.930926e+00, 1.835034e+00, 9.749964e-01, -1.967347e-01, -1.051320e+00, -1.039421e+00, 7.802050e-02, 2.113736e+00, 4.499217e+00, 6.476344e+00, 7.365224e+00, 6.808608e+00, 4.901576e+00, 2.157914e+00, -6.742102e-01, -2.878345e+00, -4.018334e+00, -4.077269e+00, -3.436555e+00, -2.705551e+00, -2.468693e+00, -3.047936e+00, -4.371948e+00, -6.002313e+00, -7.306726e+00, -7.712671e+00, -6.943875e+00, -5.147876e+00, -2.863956e+00, -8.411467e-01, 2.270123e-01, -4.766105e-02, -1.606856e+00, -3.966209e+00, -6.389677e+00, -8.152594e+00, -8.795243e+00, -8.272859e+00, -6.947603e+00, -5.428008e+00, -4.319116e+00, -3.979953e+00, -4.381682e+00, -5.120892e+00, -5.582887e+00, -5.192233e+00, -3.654045e+00, -1.092469e+00, 1.968541e+00, 4.777386e+00, 6.617046e+00, 7.059971e+00, 6.120473e+00, 4.247622e+00, 2.161324e+00, 5.929510e-01, 2.739479e-02, 5.423089e-01, 1.803137e+00, 3.213336e+00, 4.160491e+00, 4.263040e+00, 3.522605e+00, 2.323445e+00, 1.279215e+00, 9.858963e-01, 1.776003e+00, 3.569231e+00, 5.878518e+00, 7.971682e+00, 9.129702e+00, 8.905746e+00, 7.288183e+00, 4.706566e+00, 1.878311e+00, -4.465880e-01, -1.747474e+00, -1.904322e+00, -1.215851e+00, -2.601053e-01, 3.472431e-01, 2.031781e-01, -7.201924e-01, -2.063414e+00, -3.222414e+00, -3.591380e+00, -2.812314e+00, -9.346895e-01, 1.577641e+00, 3.997412e+00, 5.587932e+00, 5.865890e+00, 4.774887e+00, 2.704781e+00, 3.496106e-01, -1.542689e+00, -2.435272e+00, -2.183531e+00, -1.066062e+00, 3.438601e-01, 1.415187e+00, 1.712539e+00, 1.168590e+00, 1.091794e-01, -8.784407e-01, -1.183612e+00, -4.249229e-01, 1.380234e+00, 3.795801e+00, 6.106941e+00, 7.569035e+00, 7.673522e+00, 6.331372e+00, 3.905556e+00, 1.080356e+00, -1.383579e+00, -2.916907e+00, -3.332459e+00, -2.869265e+00, -2.075551e+00, -1.577495e+00, -1.823531e+00, -2.902771e+00, -4.507315e+00, -6.052979e+00, -6.912085e+00, -6.668807e+00, -5.298400e+00, -3.200109e+00, -1.068825e+00, 3.482421e-01, 5.197408e-01, -6.768742e-01, -2.909810e+00, -5.511900e+00, -7.719533e+00, -8.942284e+00, -8.962895e+00, -7.994104e+00, -6.573253e+00, -5.337051e+00, -4.764007e+00, -4.983815e+00, -5.726922e+00, -6.433631e+00, -6.480812e+00, -5.439021e+00, -3.260661e+00, -3.255607e-01, 2.675810e+00, 4.979678e+00, 6.019075e+00, 5.626021e+00, 4.090188e+00, 2.052105e+00, 2.709223e-01, -6.464370e-01, -4.538608e-01, 6.644571e-01, 2.187511e+00, 3.476105e+00, 4.031566e+00, 3.694800e+00, 2.709197e+00, 1.623228e+00, 1.070147e+00, 1.509501e+00, 3.030248e+00, 5.292353e+00, 7.631468e+00, 9.289419e+00, 9.685323e+00, 8.626215e+00, 6.378418e+00, 3.572888e+00, 9.799563e-01, -7.623492e-01, -1.365230e+00, -9.713313e-01, -7.356020e-02, 6.962270e-01, 8.263454e-01, 1.322132e-01, -1.168474e+00, -2.541210e+00, -3.347992e+00, -3.106489e+00, -1.695052e+00, 5.763465e-01, 3.058609e+00, 4.986816e+00, 5.751908e+00, 5.119514e+00, 3.314108e+00, 9.369978e-01, -1.251136e+00, -2.601811e+00, -2.803216e+00, -1.974664e+00, -5.976563e-01, 6.878792e-01, 1.342732e+00, 1.142949e+00, 2.673189e-01, -7.757683e-01, -1.353966e+00, -9.700487e-01, 5.255440e-01, 2.851494e+00, 5.375730e+00, 7.331012e+00, 8.086497e+00, 7.374157e+00, 5.385421e+00, 2.701845e+00, 8.579646e-02, -1.790578e+00, -2.577065e+00, -2.352119e+00, -1.566617e+00, -8.484312e-01, -7.441872e-01, -1.497923e+00, -2.951811e+00, -4.607071e+00, -5.821721e+00, -6.069205e+00, -5.158175e+00, -3.328005e+00, -1.181407e+00, 5.227511e-01, 1.140106e+00, 3.741636e-01, -1.614895e+00, -4.266728e+00, -6.821521e+00, -8.589809e+00, -9.190818e+00, -8.671142e+00, -7.461207e+00, -6.188502e+00, -5.420674e+00, -5.437718e+00, -6.120898e+00, -7.001024e+00, -7.447564e+00, -6.925874e+00, -5.223410e+00, -2.556983e+00, 4.820316e-01, 3.126265e+00, 4.701759e+00, 4.867980e+00, 3.738777e+00, 1.839033e+00, -8.672024e-02, -1.342106e+00, -1.523183e+00, -6.486869e-01, 8.707395e-01, 2.410222e+00, 3.385593e+00, 3.487066e+00, 2.801777e+00, 1.778132e+00, 1.045680e+00, 1.159701e+00, 2.368949e+00, 4.496689e+00, 6.982521e+00, 9.071624e+00, 1.008198e+01, 9.650157e+00, 7.863869e+00, 5.231571e+00, 2.500546e+00, 3.914697e-01, -6.515118e-01, -6.025494e-01, 1.635899e-01, 1.039447e+00, 1.437020e+00, 1.026587e+00, -1.297307e-01, -1.600983e+00, -2.758175e+00, -3.027232e+00, -2.126727e+00, -1.982022e-01, 2.222701e+00, 4.385832e+00, 5.591087e+00, 5.439595e+00, 3.977711e+00, 1.679917e+00, -7.229581e-01, -2.505910e+00, -3.204442e+00, -2.767247e+00, -1.551387e+00, -1.642367e-01, 7.855388e-01, 9.316479e-01, 2.947006e-01, -7.278706e-01, -1.522601e+00, -1.509699e+00, -3.854852e-01, 1.736406e+00, 4.340994e+00, 6.681547e+00, 8.040888e+00, 7.987382e+00, 6.530014e+00, 4.114541e+00, 1.462170e+00, -6.888650e-01, -1.842314e+00, -1.907351e+00, -1.206846e+00, -3.298314e-01, 1.135364e-01, -2.603948e-01, -1.453915e+00, -3.085359e+00, -4.539807e+00, -5.215206e+00, -4.769202e+00, -3.271142e+00, -1.199281e+00, 7.181807e-01, 1.760335e+00, 1.473550e+00, -1.628832e-01, -2.727470e+00, -5.507089e+00, -7.751102e+00, -8.934113e+00, -8.929761e+00, -8.032049e+00, -6.818601e+00, -5.910104e+00, -5.719161e+00, -6.285305e+00, -7.259535e+00, -8.044314e+00, -8.035264e+00, -6.871510e+00, -4.597814e+00, -1.674662e+00, 1.170000e+00, 3.193621e+00, 3.902702e+00, 3.228895e+00, 1.551664e+00, -4.409376e-01, -2.001233e+00, -2.587599e+00, -2.048037e+00, -6.543659e-01, 1.023493e+00, 2.353089e+00, 2.893532e+00, 2.570220e+00, 1.703106e+00, 8.776765e-01, 7.081889e-01, 1.584289e+00, 3.498994e+00, 6.025564e+00, 8.454521e+00, 1.004127e+01, 1.027255e+01, 9.052301e+00, 6.737328e+00, 4.009509e+00, 1.632240e+00, 1.821839e-01, -1.439521e-01, 4.233238e-01, 1.340385e+00, 1.980249e+00, 1.888764e+00, 9.684495e-01, -4.806640e-01, -1.878914e+00, -2.598361e+00, -2.218656e+00, -7.085500e-01, 1.538015e+00, 3.827391e+00, 5.408110e+00, 5.739606e+00, 4.687512e+00, 2.572491e+00, 5.429214e-02, -2.105541e+00, -3.313640e+00, -3.346953e+00, -2.412713e+00, -1.045955e+00, 1.141631e-01, 5.823041e-01, 2.197542e-01, -7.119909e-01, -1.657396e+00, -1.992022e+00, -1.280004e+00, 5.355959e-01, 3.084032e+00, 5.680691e+00, 7.562800e+00, 8.159860e+00, 7.297996e+00, 5.261809e+00, 2.690586e+00, 3.477516e-01, -1.150248e+00, -1.544672e+00, -1.007174e+00, -4.937962e-02, 6.939427e-01, 7.237261e-01, -1.223605e-01, -1.603974e+00, -3.172583e+00, -4.190114e+00, -4.187714e+00, -3.064749e+00, -1.150387e+00, 8.980176e-01, 2.323635e+00, 2.541429e+00, 1.350843e+00, -9.896674e-01, -3.854193e+00, -6.472764e+00, -8.203086e+00, -8.749421e+00, -8.247883e+00, -7.188301e+00, -6.204750e+00, -5.816361e+00, -6.218445e+00, -7.204225e+00, -8.247230e+00, -8.712733e+00, -8.116927e+00, -6.333837e+00, -3.669301e+00, -7.715045e-01, 1.590489e+00, 2.798489e+00, 2.605992e+00, 1.225513e+00, -7.502395e-01, -2.563794e+00, -3.564372e+00, -3.434173e+00, -2.285861e+00, -5.967430e-01, 9.929981e-01, 1.939319e+00, 2.010629e+00, 1.378250e+00, 5.463398e-01, 1.481718e-01, 6.871266e-01, 2.322297e+00, 4.782189e+00, 7.441683e+00, 9.535556e+00, 1.042987e+01, 9.850171e+00, 7.981117e+00, 5.400346e+00, 2.871209e+00, 1.071957e+00, 3.622831e-01, 6.735568e-01, 1.561876e+00, 2.401341e+00, 2.641988e+00, 2.032754e+00, 7.236850e-01, -7.918771e-01, -1.872970e+00, -1.989372e+00, -9.430694e-01, 1.033260e+00, 3.340491e+00, 5.218114e+00, 6.014639e+00, 5.422661e+00, 3.590723e+00, 1.070076e+00, -1.383724e+00, -3.080183e+00, -3.633721e+00, -3.085236e+00, -1.861711e+00, -5.916441e-01, 1.514635e-01, 7.846210e-02, -7.014475e-01, -1.725822e+00, -2.365848e+00, -2.083150e+00, -6.575138e-01, 1.702938e+00, 4.413352e+00, 6.708467e+00, 7.911553e+00, 7.675952e+00, 6.108959e+00, 3.731720e+00, 1.290169e+00, -5.122381e-01, -1.260259e+00, -9.600166e-01, -1.148907e-02, 9.667632e-01, 1.391879e+00, 9.516882e-01, -2.700037e-01, -1.825950e+00, -3.083344e+00, -3.478710e+00, -2.751618e+00, -1.066555e+00, 1.025645e+00, 2.774630e+00, 3.497099e+00, 2.823966e+00, 8.357224e-01, -1.964668e+00, -4.831250e+00, -7.039786e+00, -8.138956e+00, -8.094900e+00, -7.276766e+00, -6.291220e+00, -5.731035e+00, -5.935013e+00, -6.851666e+00, -8.059006e+00, -8.932870e+00, -8.899117e+00, -7.672574e+00, -5.390068e+00, -2.584748e+00, -8.915706e-03, 1.629814e+00, 1.920989e+00, 8.981529e-01, -9.749217e-01, -2.973394e+00, -4.372605e+00, -4.703856e+00, -3.909754e+00, -2.342615e+00, -6.089478e-01, 6.786716e-01, 1.146344e+00, 8.060178e-01, 4.859580e-02, -5.143496e-01, -2.994255e-01, 1.005009e+00, 3.294929e+00, 6.063335e+00, 8.567234e+00, 1.008799e+01, 1.018836e+01, 8.870209e+00, 6.573944e+00, 4.019789e+00, 1.950371e+00, 8.706765e-01, 8.819729e-01, 1.670241e+00, 2.651019e+00, 3.213345e+00, 2.968277e+00, 1.906280e+00, 4.029795e-01, -9.289313e-01, -1.484807e+00, -9.158449e-01, 7.163218e-01, 2.939176e+00, 5.025630e+00, 6.250201e+00, 6.149960e+00, 4.692807e+00, 2.290083e+00, -3.512098e-01, -2.481288e+00, -3.571122e+00, -3.488696e+00, -2.523524e+00, -1.252605e+00, -3.010284e-01, -9.000549e-02, -6.693874e-01, -1.698972e+00, -2.585765e+00, -2.724462e+00, -1.748573e+00, 3.049831e-01, 2.982567e+00, 5.559353e+00, 7.290965e+00, 7.677922e+00, 6.644232e+00, 4.563338e+00, 2.121724e+00, 7.126166e-02, -1.037151e+00, -1.039602e+00, -1.966147e-01, 9.296936e-01, 1.709791e+00, 1.701385e+00, 8.264446e-01, -5.974053e-01, -1.983192e+00, -2.710091e+00, -2.377512e+00, -9.795703e-01, 1.068520e+00, 3.064568e+00, 4.265619e+00, 4.154980e+00, 2.630430e+00, 4.315563e-02, -2.927190e+00, -5.514557e+00, -7.135283e+00, -7.583614e+00, -7.082178e+00, -6.170782e+00, -5.478139e+00, -5.465207e+00, -6.239086e+00, -7.509003e+00, -8.701305e+00, -9.189319e+00, -8.549671e+00, -6.746033e+00, -4.168370e+00, -1.510308e+00, 4.712806e-01, 1.225521e+00, 6.051623e-01, -1.081296e+00, -3.182505e+00, -4.939891e+00, -5.757924e+00, -5.408401e+00, -4.093554e+00, -2.346500e+00, -8.091746e-01, 2.593400e-02, 1.072849e-02, -6.017835e-01, -1.260735e+00, -1.340939e+00, -4.007182e-01, 1.625569e+00, 4.375577e+00, 7.169789e+00, 9.245540e+00, 1.002772e+01, 9.335258e+00, 7.446120e+00, 4.996558e+00, 2.752264e+00, 1.337024e+00, 1.019887e+00, 1.639291e+00, 2.690415e+00, 3.540192e+00, 3.686259e+00, 2.959957e+00, 1.595323e+00, 1.375533e-01, -7.739290e-01, -6.644390e-01, 5.749177e-01, 2.622523e+00, 4.824825e+00, 6.423263e+00, 6.825694e+00, 5.821132e+00, 3.657470e+00, 9.530633e-01, -1.524735e+00, -3.131305e+00, -3.565532e+00, -2.958150e+00, -1.796649e+00, -7.176579e-01, -2.477205e-01, -5.924946e-01, -1.555397e+00, -2.616924e+00, -3.144170e+00, -2.649998e+00, -1.001821e+00, 1.501361e+00, 4.215366e+00, 6.370404e+00, 7.342835e+00, 6.877899e+00, 5.180178e+00, 2.837937e+00, 6.097088e-01, -8.470392e-01, -1.204005e+00, -5.626121e-01, 6.086605e-01, 1.673979e+00, 2.088960e+00, 1.618684e+00, 4.311029e-01, -9.700222e-01, -1.946891e+00, -1.986599e+00, -9.173716e-01, 1.002045e+00, 3.156159e+00, 4.784154e+00, 5.251056e+00, 4.277635e+00, 2.043095e+00, -8.779349e-01, -3.720529e+00, -5.800031e+00, -6.747189e+00, -6.620933e+00, -5.858502e+00, -5.084323e+00, -4.852409e+00, -5.421775e+00, -6.651293e+00, -8.054362e+00, -8.992456e+00, -8.933156e+00, -7.673237e+00, -5.440083e+00, -2.830573e+00, -6.081407e-01, 5.673446e-01, 3.763331e-01, -1.045495e+00, -3.157176e+00, -5.208546e+00, -6.509104e+00, -6.669343e+00, -5.725191e+00, -4.100767e+00, -2.426045e+00, -1.280795e+00, -9.637236e-01, -1.375594e+00, -2.061169e+00, -2.393844e+00, -1.831999e+00, -1.482399e-01, 2.457521e+00, 5.406449e+00, 7.934814e+00, 9.362410e+00, 9.335561e+00, 7.953903e+00, 5.733507e+00, 3.420164e+00, 1.722684e+00, 1.065734e+00, 1.453794e+00, 2.495406e+00, 3.576016e+00, 4.111570e+00, 3.784799e+00, 2.673242e+00, 1.219852e+00, 5.741202e-02, -2.457778e-01, 5.789889e-01, 2.376106e+00, 4.600978e+00, 6.504452e+00, 7.398734e+00, 6.905897e+00, 5.096110e+00, 2.463832e+00, -2.491570e-01, -2.317679e+00, -3.285556e+00, -3.112888e+00, -2.164798e+00, -1.048384e+00, -3.620634e-01, -4.542593e-01, -1.284328e+00, -2.439120e+00, -3.298808e+00, -3.288289e+00, -2.117295e+00, 8.385344e-02, 2.786736e+00, 5.239533e+00, 6.730091e+00, 6.839629e+00, 5.592352e+00, 3.445007e+00, 1.120320e+00, -6.533284e-01, -1.398768e+00, -1.048076e+00, 5.576747e-02, 1.311781e+00, 2.108140e+00, 2.067921e+00, 1.198856e+00, -1.104087e-01, -1.246108e+00, -1.617340e+00, -9.007658e-01, 8.127581e-01, 3.027571e+00, 5.007536e+00, 6.035376e+00, 5.670698e+00, 3.910351e+00, 1.191084e+00, -1.766510e+00, -4.214395e+00, -5.638091e+00, -5.925384e+00, -5.381154e+00, -4.585239e+00, -4.149599e+00, -4.468921e+00, -5.560712e+00, -7.056343e+00, -8.346503e+00, -8.825235e+00, -8.138634e+00, -6.341975e+00, -3.903378e+00, -1.550147e+00, -1.365956e-02, 2.325191e-01, -8.564632e-01, -2.880782e+00, -5.140889e+00, -6.889113e+00, -7.593925e+00, -7.118629e+00, -5.749070e+00, -4.062305e+00, -2.688409e+00, -2.057738e+00, -2.230983e+00, -2.877265e+00, -3.408648e+00, -3.219395e+00, -1.937850e+00, 4.065124e-01, 3.366534e+00];
    I = [1.882042e-03, 2.051379e-03, 1.862427e-03, 1.399420e-03, 8.302805e-04, 3.458509e-04, 9.183146e-05, 1.187784e-04, 3.686109e-04, 7.021826e-04, 9.569287e-04, 1.012262e-03, 8.375733e-04, 5.044253e-04, 1.582843e-04, -3.936920e-05, 2.368755e-05, 3.629286e-04, 8.858822e-04, 1.422020e-03, 1.782940e-03, 1.830485e-03, 1.527345e-03, 9.511471e-04, 2.667455e-04, -3.329288e-04, -6.953261e-04, -7.605208e-04, -5.779507e-04, -2.818662e-04, -3.534089e-05, 3.545148e-05, -1.085872e-04, -4.040931e-04, -7.105260e-04, -8.664197e-04, -7.549878e-04, -3.537971e-04, 2.508362e-04, 8.907400e-04, 1.374423e-03, 1.555549e-03, 1.385765e-03, 9.320888e-04, 3.523296e-04, -1.622570e-04, -4.556046e-04, -4.611536e-04, -2.217608e-04, 1.318011e-04, 4.350635e-04, 5.557710e-04, 4.461218e-04, 1.613117e-04, -1.627097e-04, -3.637241e-04, -3.190439e-04, 2.730436e-06, 5.241190e-04, 1.082560e-03, 1.487120e-03, 1.587105e-03, 1.326943e-03, 7.667643e-04, 6.094989e-05, -5.973289e-04, -1.044826e-03, -1.204547e-03, -1.108848e-03, -8.810958e-04, -6.834105e-04, -6.507822e-04, -8.369406e-04, -1.192741e-03, -1.585349e-03, -1.850855e-03, -1.860129e-03, -1.572552e-03, -1.056761e-03, -4.700027e-04, -3.373800e-06, 1.867781e-04, 3.568239e-05, -4.060981e-04, -9.909028e-04, -1.527378e-03, -1.849059e-03, -1.872523e-03, -1.623561e-03, -1.221997e-03, -8.314523e-04, -5.935885e-04, -5.721569e-04, -7.283029e-04, -9.365809e-04, -1.035517e-03, -8.932998e-04, -4.632972e-04, 1.921381e-04, 9.191608e-04, 1.525145e-03, 1.847140e-03, 1.810528e-03, 1.455908e-03, 9.241303e-04, 4.050672e-04, 6.931971e-05, 8.356528e-06, 2.052979e-04, 5.468722e-04, 8.714640e-04, 1.034535e-03, 9.662150e-04, 6.989605e-04, 3.546897e-04, 9.633755e-05, 6.242590e-05, 3.098293e-04, 7.869123e-04, 1.347764e-03, 1.802676e-03, 1.986240e-03, 1.817629e-03, 1.330513e-03, 6.613339e-04, 3.521848e-07, -4.762393e-04, -6.677642e-04, -5.812740e-04, -3.228596e-04, -5.191484e-05, 8.379873e-05, 7.250034e-06, -2.572845e-04, -5.938773e-04, -8.411255e-04, -8.571192e-04, -5.782046e-04, -4.878662e-05, 5.896720e-04, 1.146840e-03, 1.451143e-03, 1.411609e-03, 1.050781e-03, 4.963477e-04, -6.537332e-05, -4.566865e-04, -5.713564e-04, -4.096882e-04, -7.308464e-05, 2.793086e-04, 4.949266e-04, 4.882773e-04, 2.743842e-04, -3.762403e-05, -2.882991e-04, -3.322230e-04, -9.816310e-05, 3.782441e-04, 9.622146e-04, 1.465573e-03, 1.713712e-03, 1.608807e-03, 1.165607e-03, 5.063803e-04, -1.831085e-04, -7.201116e-04, -9.890404e-04, -9.793961e-04, -7.836510e-04, -5.564461e-04, -4.510948e-04, -5.579034e-04, -8.679974e-04, -1.276519e-03, -1.623962e-03, -1.759780e-03, -1.603826e-03, -1.181851e-03, -6.211010e-04, -1.071116e-04, 1.824298e-04, 1.421129e-04, -2.225920e-04, -7.970428e-04, -1.398824e-03, -1.843329e-03, -2.009018e-03, -1.878061e-03, -1.537504e-03, -1.141062e-03, -8.465511e-04, -7.531076e-04, -8.623109e-04, -1.078095e-03, -1.245470e-03, -1.213172e-03, -8.961684e-04, -3.138406e-04, 4.111596e-04, 1.093508e-03, 1.550408e-03, 1.667122e-03, 1.438321e-03, 9.697510e-04, 4.395741e-04, 3.387646e-05, -1.195431e-04, 5.551981e-06, 3.293727e-04, 7.015938e-04, 9.628153e-04, 1.008251e-03, 8.291732e-04, 5.162399e-04, 2.234298e-04, 1.064394e-04, 2.592118e-04, 6.731066e-04, 1.234713e-03, 1.763686e-03, 2.076790e-03, 2.054316e-03, 1.684023e-03, 1.066110e-03, 3.773472e-04, -1.922271e-04, -5.063527e-04, -5.283890e-04, -3.290970e-04, -5.397595e-05, 1.369245e-04, 1.334408e-04, -8.078870e-05, -4.217634e-04, -7.384185e-04, -8.730035e-04, -7.253379e-04, -2.961469e-04, 3.074748e-04, 9.070986e-04, 1.315752e-03, 1.405118e-03, 1.152024e-03, 6.467756e-04, 6.021466e-05, -4.181681e-04, -6.479047e-04, -5.857853e-04, -2.968877e-04, 7.523122e-05, 3.673522e-04, 4.616637e-04, 3.320789e-04, 5.404871e-05, -2.258670e-04, -3.489865e-04, -2.093795e-04, 2.004020e-04, 7.805945e-04, 1.356364e-03, 1.739171e-03, 1.794574e-03, 1.491107e-03, 9.119266e-04, 2.248237e-04, -3.781518e-04, -7.488802e-04, -8.337488e-04, -6.879660e-04, -4.487443e-04, -2.780628e-04, -2.971836e-04, -5.381087e-04, -9.305946e-04, -1.329695e-03, -1.573262e-03, -1.547326e-03, -1.234147e-03, -7.242234e-04, -1.871439e-04, 1.881878e-04, 2.617755e-04, -6.308676e-06, -5.410078e-04, -1.179220e-03, -1.728509e-03, -2.035625e-03, -2.039268e-03, -1.787624e-03, -1.414558e-03, -1.084052e-03, -9.244120e-04, -9.775610e-04, -1.182852e-03, -1.401593e-03, -1.472864e-03, -1.279172e-03, -7.966513e-04, -1.102454e-04, 6.124271e-04, 1.179177e-03, 1.441779e-03, 1.349329e-03, 9.664426e-04, 4.494556e-04, -1.045610e-05, -2.559416e-04, -2.183010e-04, 6.181084e-05, 4.551040e-04, 7.974000e-04, 9.555487e-04, 8.801531e-04, 6.248801e-04, 3.249731e-04, 1.432161e-04, 2.041018e-04, 5.415651e-04, 1.080595e-03, 1.660245e-03, 2.089864e-03, 2.217708e-03, 1.986317e-03, 1.453880e-03, 7.735730e-04, 1.385913e-04, -2.865566e-04, -4.228517e-04, -3.006390e-04, -4.208038e-05, 1.906082e-04, 2.610154e-04, 1.131285e-04, -2.062841e-04, -5.660727e-04, -8.028260e-04, -7.866981e-04, -4.755972e-04, 6.330201e-05, 6.734257e-04, 1.163065e-03, 1.373959e-03, 1.238597e-03, 8.047669e-04, 2.181331e-04, -3.306270e-04, -6.743425e-04, -7.279325e-04, -5.153353e-04, -1.551188e-04, 1.892299e-04, 3.749983e-04, 3.366305e-04, 1.111728e-04, -1.769537e-04, -3.659934e-04, -3.224912e-04, 2.751635e-06, 5.501093e-04, 1.167816e-03, 1.664136e-03, 1.875742e-03, 1.726790e-03, 1.256569e-03, 6.053261e-04, -3.640104e-05, -4.960022e-04, -6.790684e-04, -5.993681e-04, -3.677098e-04, -1.444673e-04, -7.427316e-05, -2.280479e-04, -5.746173e-04, -9.927893e-04, -1.319254e-03, -1.413923e-03, -1.217566e-03, -7.794219e-04, -2.437755e-04, 1.999554e-04, 3.852035e-04, 2.289387e-04, -2.376760e-04, -8.801715e-04, -1.509139e-03, -1.947969e-03, -2.094664e-03, -1.954771e-03, -1.633497e-03, -1.290552e-03, -1.075349e-03, -1.067541e-03, -1.245713e-03, -1.496228e-03, -1.658808e-03, -1.591355e-03, -1.229069e-03, -6.149619e-04, 1.103345e-04, 7.561722e-04, 1.149371e-03, 1.196428e-03, 9.171663e-04, 4.371968e-04, -5.797871e-05, -3.900401e-04, -4.510203e-04, -2.390971e-04, 1.460281e-04, 5.458628e-04, 8.072599e-04, 8.432208e-04, 6.670285e-04, 3.866366e-04, 1.614836e-04, 1.383109e-04, 3.906719e-04, 8.855329e-04, 1.490166e-03, 2.017273e-03, 2.291748e-03, 2.214202e-03, 1.797457e-03, 1.162314e-03, 4.941682e-04, -2.329467e-05, -2.725426e-04, -2.408196e-04, -1.885261e-05, 2.393056e-04, 3.795495e-04, 3.096821e-04, 3.626610e-05, -3.377609e-04, -6.537818e-04, -7.608904e-04, -5.776063e-04, -1.280588e-04, 4.616085e-04, 1.005803e-03, 1.325402e-03, 1.312476e-03, 9.695873e-04, 4.089293e-04, -1.883948e-04, -6.376918e-04, -8.161780e-04, -7.042833e-04, -3.876299e-04, -1.948727e-05, 2.415435e-04, 2.945580e-04, 1.358837e-04, -1.400187e-04, -3.786134e-04, -4.276910e-04, -2.001182e-04, 2.873144e-04, 9.142085e-04, 1.496482e-03, 1.851295e-03, 1.862821e-03, 1.524251e-03, 9.402842e-04, 2.891527e-04, -2.415894e-04, -5.215046e-04, -5.212010e-04, -3.176287e-04, -5.929363e-05, 9.489372e-05, 3.949957e-05, -2.353698e-04, -6.399463e-04, -1.020190e-03, -1.219110e-03, -1.140457e-03, -7.901960e-04, -2.795202e-04, 2.122880e-04, 5.015924e-04, 4.670237e-04, 9.405618e-05, -5.191830e-04, -1.197071e-03, -1.749453e-03, -2.038867e-03, -2.026989e-03, -1.783232e-03, -1.452784e-03, -1.196745e-03, -1.127520e-03, -1.264286e-03, -1.525619e-03, -1.762075e-03, -1.816233e-03, -1.587109e-03, -1.074094e-03, -3.832196e-04, 3.071663e-04, 8.088616e-04, 9.911840e-04, 8.280736e-04, 4.072656e-04, -1.019136e-04, -5.100621e-04, -6.755086e-04, -5.531350e-04, -2.062189e-04, 2.226428e-04, 5.699763e-04, 7.166236e-04, 6.346287e-04, 3.978466e-04, 1.522284e-04, 5.719202e-05, 2.206072e-04, 6.524733e-04, 1.255369e-03, 1.855850e-03, 2.265426e-03, 2.348479e-03, 2.071716e-03, 1.516623e-03, 8.502302e-04, 2.651212e-04, -8.885478e-05, -1.557278e-04, 1.146649e-05, 2.767503e-04, 4.780297e-04, 4.926626e-04, 2.865454e-04, -7.210744e-05, -4.395659e-04, -6.536838e-04, -5.993665e-04, -2.571732e-04, 2.838801e-04, 8.547195e-04, 1.265586e-03, 1.374353e-03, 1.138244e-03, 6.295776e-04, 9.604943e-06, -5.297531e-04, -8.344700e-04, -8.417010e-04, -5.981014e-04, -2.367806e-04, 7.783020e-05, 2.158241e-04, 1.330483e-04, -1.119193e-04, -3.815362e-04, -5.146712e-04, -3.923147e-04, 1.170519e-05, 6.147400e-04, 1.250690e-03, 1.727658e-03, 1.896523e-03, 1.704815e-03, 1.215708e-03, 5.850022e-04, 4.701146e-06, -3.656743e-04, -4.544217e-04, -2.991580e-04, -2.689072e-05, 1.992418e-04, 2.458816e-04, 6.264668e-05, -2.977953e-04, -7.004585e-04, -9.816176e-04, -1.014663e-03, -7.628674e-04, -2.985673e-04, 2.190604e-04, 5.997403e-04, 6.907135e-04, 4.325933e-04, -1.184763e-04, -8.106867e-04, -1.451028e-03, -1.873969e-03, -1.998720e-03, -1.853879e-03, -1.560666e-03, -1.281668e-03, -1.155000e-03, -1.239257e-03, -1.490356e-03, -1.779150e-03, -1.943036e-03, -1.851744e-03, -1.461972e-03, -8.396586e-04, -1.408975e-04, 4.418238e-04, 7.481826e-04, 7.077856e-04, 3.655032e-04, -1.351326e-04, -6.042506e-04, -8.740884e-04, -8.580018e-04, -5.781503e-04, -1.519058e-04, 2.573187e-04, 5.056890e-04, 5.257468e-04, 3.525976e-04, 1.094704e-04, -4.179808e-05, 3.366265e-05, 3.873701e-04, 9.621561e-04, 1.608041e-03, 2.133850e-03, 2.375504e-03, 2.255510e-03, 1.811352e-03, 1.182138e-03, 5.584809e-04, 1.143779e-04, -5.346418e-05, 4.364145e-05, 2.966831e-04, 5.458502e-04, 6.457209e-04, 5.236100e-04, 2.086791e-04, -1.793443e-04, -4.775070e-04, -5.448608e-04, -3.204870e-04, 1.481570e-04, 7.178553e-04, 1.198979e-03, 1.423356e-03, 1.305357e-03, 8.732939e-04, 2.593762e-04, -3.480537e-04, -7.721048e-04, -9.094967e-04, -7.642078e-04, -4.403971e-04, -9.783469e-05, 1.127550e-04, 1.095123e-04, -8.853343e-05, -3.694952e-04, -5.736162e-04, -5.579385e-04, -2.557664e-04, 2.920964e-04, 9.467282e-04, 1.518091e-03, 1.832355e-03, 1.794455e-03, 1.422460e-03, 8.408636e-04, 2.352992e-04, -2.143494e-04, -3.974518e-04, -3.091369e-04, -4.650254e-05, 2.334834e-04, 3.779136e-04, 2.990436e-04, 9.102886e-06, -3.845186e-04, -7.218531e-04, -8.543626e-04, -7.057569e-04, -3.061038e-04, 2.142339e-04, 6.690842e-04, 8.830258e-04, 7.552134e-04, 2.965719e-04, -3.736044e-04, -1.070391e-03, -1.609316e-03, -1.871084e-03, -1.840886e-03, -1.607920e-03, -1.325889e-03, -1.149944e-03, -1.174453e-03, -1.395470e-03, -1.712301e-03, -1.967547e-03, -2.010266e-03, -1.757949e-03, -1.233379e-03, -5.618387e-04, 7.080367e-05, 4.837948e-04, 5.664990e-04, 3.183916e-04, -1.509613e-04, -6.619353e-04, -1.029898e-03, -1.130947e-03, -9.438684e-04, -5.529327e-04, -1.110196e-04, 2.224299e-04, 3.446766e-04, 2.498653e-04, 3.073483e-05, -1.587774e-04, -1.656781e-04, 9.908744e-05, 6.211258e-04, 1.282083e-03, 1.898884e-03, 2.288373e-03, 2.333313e-03, 2.025036e-03, 1.466755e-03, 8.362837e-04, 3.221112e-04, 5.675049e-05, 7.216340e-05, 2.936340e-04, 5.738506e-04, 7.537420e-04, 7.265463e-04, 4.804908e-04, 1.037179e-04, -2.504214e-04, -4.243914e-04, -3.203647e-04, 5.767421e-05, 6.000968e-04, 1.128072e-03, 1.456995e-03, 1.463303e-03, 1.129697e-03, 5.517825e-04, -9.635646e-05, -6.247730e-04, -8.950403e-04, -8.672991e-04, -6.096592e-04, -2.669470e-04, -1.178672e-06, 7.321758e-05, -6.546659e-05, -3.380275e-04, -5.962191e-04, -6.824463e-04, -4.943384e-04, -2.928077e-05, 6.085022e-04, 1.241562e-03, 1.681335e-03, 1.795678e-03, 1.556566e-03, 1.050099e-03, 4.450282e-04, -6.838408e-05, -3.463069e-04, -3.407489e-04, -1.122220e-04, 1.985910e-04, 4.288874e-04, 4.590436e-04, 2.600567e-04, -9.505787e-05, -4.602678e-04, -6.747916e-04, -6.282483e-04, -3.075663e-04, 1.926444e-04, 7.007398e-04, 1.028625e-03, 1.039776e-03, 6.992603e-04, 8.700324e-05, -6.306972e-04, -1.260749e-03, -1.651651e-03, -1.745185e-03, -1.592356e-03, -1.328073e-03, -1.114741e-03, -1.076614e-03, -1.250165e-03, -1.569509e-03, -1.892454e-03, -2.057188e-03, -1.947817e-03, -1.543506e-03, -9.320721e-04, -2.823337e-04, 2.148561e-04, 4.150085e-04, 2.722774e-04, -1.439789e-04, -6.745718e-04, -1.128290e-03, -1.350502e-03, -1.276953e-03, -9.528738e-04, -5.106964e-04, -1.153642e-04, 1.015526e-04, 9.359786e-05, -8.281004e-05, -2.913854e-04, -3.709094e-04, -2.009853e-04, 2.467269e-04, 8.917315e-04, 1.569290e-03, 2.087611e-03, 2.296455e-03, 2.141508e-03, 1.684174e-03, 1.079328e-03, 5.193703e-04, 1.655225e-04, 9.199117e-05, 2.636746e-04, 5.553002e-04, 8.041909e-04, 8.761643e-04, 7.191960e-04, 3.842564e-04, 5.345552e-06, -2.536162e-04, -2.646489e-04, 1.103394e-05, 5.030623e-04, 1.053348e-03, 1.471341e-03, 1.602638e-03, 1.385322e-03, 8.729173e-04, 2.153266e-04, -3.951118e-04, -7.922605e-04, -8.938950e-04, -7.271098e-04, -4.123405e-04, -1.126080e-04, 3.228028e-05, -3.876403e-05, -2.841898e-04, -5.766239e-04, -7.539630e-04, -6.851173e-04, -3.250869e-04, 2.620051e-04, 9.212097e-04, 1.459999e-03, 1.716780e-03, 1.619109e-03, 1.209802e-03, 6.311457e-04, 7.311442e-05, -2.950025e-04, -3.840361e-04, -2.133846e-04, 1.017681e-04, 3.990706e-04, 5.345305e-04, 4.397102e-04, 1.486475e-04, -2.158039e-04, -4.909635e-04, -5.398320e-04, -3.079056e-04, 1.507274e-04, 6.884446e-04, 1.115142e-03, 1.266431e-03, 1.063521e-03, 5.423699e-04, -1.588667e-04, -8.493843e-04, -1.353739e-03, -1.572918e-03, -1.515809e-03, -1.289695e-03, -1.053930e-03, -9.548772e-04, -1.067184e-03, -1.363947e-03, -1.727186e-03, -1.994613e-03, -2.024742e-03, -1.755280e-03, -1.232204e-03, -5.979474e-04, -4.262138e-05, 2.637375e-04, 2.326337e-04, -1.107278e-04, -6.366563e-04, -1.158121e-03, -1.498170e-03, -1.552429e-03, -1.323464e-03, -9.145035e-04, -4.854724e-04, -1.884878e-04, -1.076978e-04, -2.265464e-04, -4.349951e-04, -5.739133e-04, -4.995890e-04, -1.435370e-04, 4.555472e-04, 1.160349e-03, 1.781322e-03, 2.143843e-03, 2.151100e-03, 1.819174e-03, 1.271152e-03, 6.924681e-04, 2.641978e-04, 9.923162e-05, 2.050596e-04, 4.867315e-04, 7.883148e-04, 9.566128e-04, 9.025576e-04, 6.366988e-04, 2.651908e-04, -5.217515e-05, -1.657894e-04, 2.645725e-06, 4.253064e-04, 9.734859e-04, 1.461444e-03, 1.712760e-03, 1.624456e-03, 1.204899e-03, 5.712295e-04, -9.271194e-05, -6.022282e-04, -8.367605e-04, -7.798649e-04, -5.195540e-04, -2.094318e-04, -5.880691e-06, -5.548735e-06, -2.071486e-04, -5.122016e-04, -7.644267e-04, -8.126522e-04, -5.730584e-04, -6.669289e-05, 5.824994e-04, 1.188947e-03, 1.570905e-03, 1.615734e-03, 1.320566e-03, 7.931279e-04, 2.123916e-04, -2.362052e-04, -4.267323e-04, -3.353816e-04, -4.408924e-05, 2.956551e-04, 5.245710e-04, 5.390677e-04, 3.320575e-04, -4.531793e-06, -3.164928e-04, -4.492189e-04, -3.109415e-04, 8.710053e-05, 6.293147e-04, 1.134298e-03, 1.419184e-03, 1.365852e-03, 9.642177e-04, 3.163696e-04, -4.000198e-04, -9.953137e-04, -1.334771e-03, -1.383758e-03, -1.214696e-03, -9.736929e-04, -8.200205e-04, -8.618667e-04, -1.113039e-03, -1.487232e-03, -1.832036e-03, -1.989651e-03, -1.860965e-03, -1.448276e-03, -8.599343e-04, -2.746018e-04, 1.218668e-04, 2.034365e-04, -5.025847e-05, -5.464258e-04, -1.112808e-03, -1.559939e-03, -1.748673e-03, -1.637823e-03, -1.294369e-03, -8.629171e-04, -5.065169e-04, -3.417303e-04, -3.929034e-04, -5.831641e-04, -7.655745e-04, -7.824737e-04, -5.302005e-04, -4.220807e-06, 6.929756e-04, 1.384764e-03];

    voltageFft = fft(V);
    currentFft = fft(I);

    % Compute the frequency axis
    fs = 100000; % Sampling frequency
    N = length(voltage512); % Num
    frequencies = (0:N-1) * fs / N; % Frequency axis

    % Find the indices corresponding to the dominant frequency components
    plot(abs(voltageFft))
    [~, VIndex] = max(abs(voltageFft));
    [~, CIndex] = max(abs(currentFft));

    % Extract the dominant frequencies
    voltageFrequency = frequencies(VIndex)
    currentFrequency = frequencies(CIndex)
    t = 1:512
    %plot(frequencies)
    
    %frequencies indices
    freq1_index = 11;
    freq2_index = 21;
    freq3_index = 52;
    freq4_index = 103;
    freq5_index = 226;
    freq6_index = 472;

    % Calculate impedance at the fundamental frequency
    zMagnitude1 = abs(voltageFft(freq1_index)) / abs(currentFft(freq1_index));
    zMagnitude2 = abs(voltageFft(freq2_index)) / abs(currentFft(freq2_index));
    zMagnitude3 = abs(voltageFft(freq3_index)) / abs(currentFft(freq3_index));
    zMagnitude4 = abs(voltageFft(freq4_index)) / abs(currentFft(freq4_index));
    zMagnitude5 = abs(voltageFft(freq5_index)) / abs(currentFft(freq5_index));
    zMagnitude6 = abs(voltageFft(freq6_index)) / abs(currentFft(freq6_index));

    zPhase1 = rad2deg(angle(voltageFft(freq1_index)) - angle(currentFft(freq1_index))); % Phase difference
    zPhase2 = rad2deg(angle(voltageFft(freq2_index)) - angle(currentFft(freq2_index))); % Phase difference
    zPhase3 = rad2deg(angle(voltageFft(freq3_index)) - angle(currentFft(freq3_index))); % Phase difference
    zPhase4 = rad2deg(angle(voltageFft(freq4_index)) - angle(currentFft(freq4_index))); % Phase difference
    zPhase5 = rad2deg(angle(voltageFft(freq5_index)) - angle(currentFft(freq5_index))); % Phase difference
    zPhase6 = rad2deg(angle(voltageFft(freq6_index)) - angle(currentFft(freq6_index))); % Phase difference

    % Display the impedance
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 976.56, zMagnitude1, zPhase1);
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 1953.13, zMagnitude2, zPhase2);
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 4980.47, zMagnitude3, zPhase3);
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 9960.94, zMagnitude4, zPhase4);
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 21972.65625, zMagnitude5, zPhase5);
    fprintf('Bioimpedance at %.2f Hz: %.6f ohms, and phase: %.6f degrees\n', 45996.09375, zMagnitude6, zPhase6);

end
